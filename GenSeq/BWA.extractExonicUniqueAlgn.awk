#!/usr/bin/awk -f
$3!= "*" && /\<X0:i:1\>/ && /\<X1:i:0\>/{  
match($3,"([^#]*)#[^#]*#(chr[^:]*):([0-9]*)-([0-9]*)#(chr[^:]*):([0-9]*)-([0-9]*)",A)
#print A[1] "\t" A[2] "\t" A[3] "\t" A[4] "\t" A[5] "\t" A[6] "\t" A[7]
#NM_015722       chr10   134991399       134991509       chr10   135000328       135000465  
junction = A[4] - A[3] + 1
readLen = length($10)
if ( $4 <= junction && junction < $4 + readLen-1) {
    match($16,"XM:i:([0-9]*)",B)
    print A[2] "\t" A[3]+$4-2 "\t" A[4] "\t" $1 "\t" B[1] "\t" (and($2,0x0010)? "-" : "+") "\t" $3 "\t" $4
}
}
